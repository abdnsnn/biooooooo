// مساعد الذكاء الاصطناعي للكيمياء الحيوية
class BiochemistryAI {
  constructor() {
    this.name = "biochemistry";
    this.knowledgeBase = {
      // قاعدة معرفة أساسية للكيمياء الحيوية
      proteins: {
        definition: "البروتينات هي جزيئات كبيرة مكونة من سلاسل الأحماض الأمينية، وتلعب أدواراً حيوية في جميع الكائنات الحية.",
        structure: "تتكون بنية البروتين من أربعة مستويات: البنية الأولية (تسلسل الأحماض الأمينية)، البنية الثانوية (مثل اللولب ألفا والصفيحة بيتا)، البنية الثالثية (الطي الثلاثي الأبعاد)، والبنية الرباعية (تجمع وحدات متعددة).",
        functions: "تؤدي البروتينات وظائف متعددة منها: الإنزيمات، النقل، الدعم الهيكلي، الحركة، الدفاع المناعي، التنظيم الهرموني، والتخزين.",
        examples: "أمثلة على البروتينات: الهيموغلوبين، الكولاجين، الأنسولين، الأجسام المضادة، الإنزيمات مثل الأميليز والليباز."
      },
      lipids: {
        definition: "الدهون هي جزيئات عضوية غير قابلة للذوبان في الماء ولكنها تذوب في المذيبات العضوية، وتلعب أدواراً مهمة في تخزين الطاقة وتكوين الأغشية الخلوية.",
        types: "تشمل أنواع الدهون: الدهون الثلاثية، الفوسفوليبيدات، الستيرويدات، الشموع، والدهون المفسفرة.",
        functions: "وظائف الدهون تشمل: تخزين الطاقة، تكوين الأغشية الخلوية، العزل الحراري، الحماية الميكانيكية، والإشارات الخلوية.",
        examples: "أمثلة على الدهون: الكوليسترول، الدهون الثلاثية، الفوسفاتيديل كولين، حمض الأوليك."
      },
      carbohydrates: {
        definition: "الكربوهيدرات هي جزيئات عضوية تتكون من الكربون والهيدروجين والأكسجين، وتعتبر المصدر الرئيسي للطاقة في معظم الكائنات الحية.",
        types: "تشمل أنواع الكربوهيدرات: السكريات الأحادية (مثل الجلوكوز)، السكريات الثنائية (مثل السكروز)، والسكريات المتعددة (مثل النشا والجلايكوجين).",
        functions: "وظائف الكربوهيدرات تشمل: توفير الطاقة، التخزين، والدعم الهيكلي في النباتات والحيوانات.",
        examples: "أمثلة على الكربوهيدرات: الجلوكوز، الفركتوز، السكروز، اللاكتوز، النشا، السليلوز، الجلايكوجين."
      },
      nucleicAcids: {
        definition: "الأحماض النووية هي جزيئات كبيرة تخزن وتنقل المعلومات الوراثية في الخلايا، وتتكون من سلاسل من النيوكليوتيدات.",
        types: "النوعان الرئيسيان من الأحماض النووية هما: الحمض النووي الريبوزي منقوص الأكسجين (DNA) والحمض النووي الريبوزي (RNA).",
        structure: "يتكون DNA من سلسلتين ملتفتين حول بعضهما في شكل حلزون مزدوج، بينما يتكون RNA عادة من سلسلة واحدة.",
        functions: "وظائف الأحماض النووية تشمل: تخزين المعلومات الوراثية، نقل المعلومات الوراثية، وتنظيم التعبير الجيني.",
        examples: "أنواع RNA تشمل: mRNA (الرسول)، tRNA (الناقل)، rRNA (الريبوسومي)، miRNA (الصغير)."
      },
      enzymes: {
        definition: "الإنزيمات هي بروتينات تعمل كمحفزات حيوية، تسرع التفاعلات الكيميائية في الكائنات الحية دون أن تستهلك في التفاعل.",
        mechanism: "تعمل الإنزيمات عن طريق خفض طاقة التنشيط اللازمة لبدء التفاعل، مما يزيد من معدل التفاعل.",
        factors: "العوامل التي تؤثر على نشاط الإنزيم تشمل: درجة الحرارة، الرقم الهيدروجيني، تركيز الركيزة، وجود المثبطات أو المنشطات.",
        examples: "أمثلة على الإنزيمات: الأميليز (يحلل النشا)، الليباز (يحلل الدهون)، البروتياز (يحلل البروتينات)، DNA بوليميراز (يبني DNA)."
      },
      metabolism: {
        definition: "الأيض هو مجموعة من التفاعلات الكيميائية التي تحدث في الكائنات الحية للحفاظ على الحياة، وينقسم إلى عمليات البناء (الأيض البنائي) وعمليات الهدم (الأيض الهدمي).",
        pathways: "المسارات الأيضية الرئيسية تشمل: الجلايكوليسيس، دورة كريبس، سلسلة نقل الإلكترون، تخليق الأحماض الدهنية، تخليق الأحماض الأمينية.",
        regulation: "يتم تنظيم الأيض من خلال آليات مختلفة منها: تنظيم نشاط الإنزيمات، التنظيم الهرموني، والتنظيم الجيني.",
        energyCurrency: "ATP (أدينوسين ثلاثي الفوسفات) هو العملة الرئيسية للطاقة في الخلايا، ويستخدم لتخزين ونقل الطاقة."
      },
      molecularBiology: {
        centralDogma: "الدوغما المركزية في البيولوجيا الجزيئية تصف تدفق المعلومات الوراثية من DNA إلى RNA إلى البروتين من خلال عمليات النسخ والترجمة.",
        transcription: "النسخ هو عملية إنتاج RNA من قالب DNA، وتتم بواسطة إنزيم RNA بوليميراز.",
        translation: "الترجمة هي عملية إنتاج البروتين من mRNA، وتتم في الريبوسومات باستخدام tRNA.",
        replication: "التضاعف هو عملية إنتاج نسخ متطابقة من DNA، وتتم قبل انقسام الخلية لضمان نقل المعلومات الوراثية إلى الخلايا الجديدة."
      },
      techniques: {
        pcr: "تفاعل البلمرة المتسلسل (PCR) هو تقنية تستخدم لتضخيم قطع محددة من DNA، وتستخدم في العديد من التطبيقات مثل التشخيص والبحث.",
        electrophoresis: "الرحلان الكهربائي هو تقنية تستخدم لفصل الجزيئات الكبيرة مثل DNA والبروتينات بناءً على حجمها وشحنتها.",
        chromatography: "الكروماتوغرافيا هي تقنية تستخدم لفصل مكونات مخلوط بناءً على خصائصها الفيزيائية والكيميائية.",
        spectroscopy: "الطيف الضوئي هو تقنية تستخدم لدراسة تفاعل المادة مع الإشعاع الكهرومغناطيسي، وتستخدم في تحديد بنية وتركيز المركبات.",
        massSpectrometry: "مطياف الكتلة هو تقنية تستخدم لتحديد الوزن الجزيئي والبنية الكيميائية للمركبات.",
        crispr: "كريسبر-كاس9 هي تقنية لتعديل الجينات تستخدم بروتين Cas9 وRNA دليلي لاستهداف وقطع DNA في مواقع محددة."
      },
      immunology: {
        definition: "علم المناعة هو دراسة جهاز المناعة والاستجابة المناعية في الكائنات الحية.",
        innateImmunity: "المناعة الفطرية هي الخط الأول من الدفاع ضد مسببات الأمراض، وتشمل الحواجز الفيزيائية والكيميائية والخلايا المناعية مثل الخلايا البلعمية.",
        adaptiveImmunity: "المناعة التكيفية هي استجابة مناعية متخصصة تتطور بعد التعرض لمسبب المرض، وتشمل الخلايا التائية والخلايا البائية.",
        antibodies: "الأجسام المضادة هي بروتينات تنتجها الخلايا البائية وتتعرف على مسببات الأمراض وتساعد في القضاء عليها."
      },
      endocrinology: {
        definition: "علم الغدد الصماء هو دراسة الهرمونات والغدد التي تنتجها وتأثيراتها على وظائف الجسم.",
        hormones: "الهرمونات هي مواد كيميائية تنتجها الغدد الصماء وتنتقل عبر الدم للتأثير على أعضاء وأنسجة محددة.",
        glands: "الغدد الصماء الرئيسية تشمل: الغدة النخامية، الغدة الدرقية، الغدة الكظرية، البنكرياس، الغدد التناسلية.",
        examples: "أمثلة على الهرمونات: الأنسولين، الجلوكاجون، الأدرينالين، الثيروكسين، الإستروجين، التستوستيرون."
      }
    };
    
    // قاعدة بيانات التجارب
    this.experiments = {
      "protein_detection_biuret": {
        title: "الكشف عن البروتينات باستخدام كاشف بيوريت",
        category: "البروتينات",
        description: "تجربة للكشف عن وجود البروتينات في العينات باستخدام كاشف بيوريت الذي يتفاعل مع الروابط الببتيدية."
      },
      "dna_extraction_fruits": {
        title: "استخلاص الحمض النووي من الفواكه",
        category: "الأحماض النووية",
        description: "تجربة لاستخلاص الحمض النووي من الفواكه باستخدام مواد بسيطة متوفرة في المنزل."
      },
      "blood_separation_centrifuge": {
        title: "فصل مكونات الدم باستخدام جهاز الطرد المركزي",
        category: "تحليل الدم",
        description: "تجربة لفصل مكونات الدم (خلايا الدم الحمراء، خلايا الدم البيضاء، الصفائح الدموية، البلازما) باستخدام جهاز الطرد المركزي."
      },
      "lipid_analysis_tlc": {
        title: "تحليل الدهون باستخدام كروماتوغرافيا الطبقة الرقيقة",
        category: "الدهون",
        description: "تجربة لفصل وتحليل أنواع مختلفة من الدهون باستخدام تقنية كروماتوغرافيا الطبقة الرقيقة."
      },
      "glucose_determination": {
        title: "تحديد تركيز الجلوكوز باستخدام طريقة الأنزيم",
        category: "السكريات",
        description: "تجربة لقياس تركيز الجلوكوز في العينات باستخدام تفاعل إنزيمي."
      },
      "elisa_immunoassay": {
        title: "تقنية الإليزا للكشف عن الأجسام المضادة",
        category: "المناعة",
        description: "تجربة لاستخدام تقنية المقايسة المناعية المرتبطة بالإنزيم (ELISA) للكشف عن الأجسام المضادة في عينات المصل."
      },
      "hormone_radioimmunoassay": {
        title: "قياس مستوى الهرمونات باستخدام المقايسة المناعية الإشعاعية",
        category: "الهرمونات",
        description: "تجربة لقياس تركيز الهرمونات في العينات البيولوجية باستخدام تقنية المقايسة المناعية الإشعاعية."
      },
      "molecular_docking_simulation": {
        title: "محاكاة الارتباط الجزيئي بين الدواء والبروتين",
        category: "الجزيئات الحيوية",
        description: "تجربة لمحاكاة ودراسة التفاعلات بين جزيئات الدواء والبروتينات المستهدفة باستخدام برامج الحاسوب."
      },
      "pcr_dna_amplification": {
        title: "تضخيم الحمض النووي باستخدام تفاعل البلمرة المتسلسل",
        category: "الأحماض النووية",
        description: "تجربة لتضخيم قطع محددة من الحمض النووي باستخدام تقنية تفاعل البلمرة المتسلسل (PCR)."
      },
      "enzyme_kinetics": {
        title: "دراسة حركية الإنزيمات وتأثير تركيز الركيزة ودرجة الحرارة",
        category: "البروتينات",
        description: "تجربة لدراسة تأثير تركيز الركيزة ودرجة الحرارة على معدل التفاعل الإنزيمي."
      },
      "spectrophotometric_analysis": {
        title: "التحليل الطيفي للمركبات الكيميائية الحيوية",
        category: "الكيمياء الحيوية التحليلية",
        description: "تجربة لتحديد تركيز المركبات الكيميائية الحيوية باستخدام تقنية التحليل الطيفي."
      },
      "chromatography_lipids": {
        title: "فصل وتحليل الدهون باستخدام كروماتوغرافيا الطبقة الرقيقة",
        category: "الدهون",
        description: "تجربة لفصل وتحليل أنواع مختلفة من الدهون باستخدام تقنية كروماتوغرافيا الطبقة الرقيقة."
      },
      "glycolysis_pathway": {
        title: "دراسة مسار تحلل الجلوكوز (الجلايكوليسيس)",
        category: "السكريات",
        description: "تجربة لدراسة المراحل المختلفة لمسار تحلل الجلوكوز وقياس نشاط الإنزيمات المشاركة."
      },
      "western_blot": {
        title: "تقنية الويسترن بلوت للكشف عن البروتينات",
        category: "البروتينات",
        description: "تجربة لاستخدام تقنية الويسترن بلوت للكشف عن بروتينات محددة في عينات معقدة."
      },
      "flow_cytometry": {
        title: "تحليل الخلايا المناعية باستخدام التدفق الخلوي",
        category: "المناعة",
        description: "تجربة لتحليل وفرز الخلايا المناعية باستخدام تقنية التدفق الخلوي."
      },
      "gene_expression_rt_pcr": {
        title: "قياس التعبير الجيني باستخدام تفاعل البلمرة المتسلسل في الوقت الحقيقي",
        category: "الأحماض النووية",
        description: "تجربة لقياس مستويات التعبير الجيني باستخدام تقنية RT-PCR."
      },
      "hormone_radioimmunoassay_insulin": {
        title: "قياس مستوى الأنسولين في الدم باستخدام المقايسة المناعية الإشعاعية",
        category: "الهرمونات",
        description: "تجربة لقياس تركيز الأنسولين في عينات الدم باستخدام تقنية المقايسة المناعية الإشعاعية."
      },
      "mass_spectrometry_protein": {
        title: "تحليل البروتينات باستخدام مطياف الكتلة",
        category: "أجهزة الفحص الحيوي",
        description: "تجربة لتحليل وتحديد هوية البروتينات باستخدام تقنية مطياف الكتلة."
      },
      "crispr_gene_editing": {
        title: "تعديل الجينات باستخدام تقنية كريسبر-كاس9",
        category: "الكيمياء الحيوية الجزيئية",
        description: "تجربة لتعديل جين محدد في خلايا مزروعة باستخدام تقنية كريسبر-كاس9."
      },
      "metabolic_pathway_analysis": {
        title: "تحليل المسارات الأيضية باستخدام الكروماتوغرافيا السائلة-مطياف الكتلة",
        category: "الكيمياء الحيوية التحليلية",
        description: "تجربة لتحليل المستقلبات في مسار الجلايكوليسيس في خلايا طبيعية وخلايا سرطانية."
      }
    };
  }

  // وظيفة للإجابة على الأسئلة المتعلقة بالكيمياء الحيوية
  answerQuestion(question) {
    // تحويل السؤال إلى أحرف صغيرة للمطابقة بشكل أفضل
    const lowerQuestion = question.toLowerCase();
    
    // البحث عن كلمات مفتاحية في السؤال
    if (this.containsKeywords(lowerQuestion, ["بروتين", "بروتينات", "حمض أميني", "أحماض أمينية"])) {
      return this.generateProteinResponse(lowerQuestion);
    } 
    else if (this.containsKeywords(lowerQuestion, ["دهن", "دهون", "ليبيد", "ليبيدات", "شحم", "شحوم"])) {
      return this.generateLipidResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["كربوهيدرات", "سكر", "سكريات", "جلوكوز", "نشا"])) {
      return this.generateCarbohydrateResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["حمض نووي", "أحماض نووية", "dna", "rna", "جين", "جينات"])) {
      return this.generateNucleicAcidResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["إنزيم", "إنزيمات", "محفز", "محفزات"])) {
      return this.generateEnzymeResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["أيض", "استقلاب", "تمثيل غذائي", "مسار", "مسارات", "طاقة", "atp"])) {
      return this.generateMetabolismResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["تجربة", "مختبر", "تقنية", "طريقة", "بروتوكول"])) {
      return this.generateExperimentResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["مناعة", "جهاز مناعي", "جسم مضاد", "أجسام مضادة", "خلية تائية", "خلية بائية"])) {
      return this.generateImmunologyResponse(lowerQuestion);
    }
    else if (this.containsKeywords(lowerQuestion, ["هرمون", "هرمونات", "غدة", "غدد"])) {
      return this.generateEndocrinologyResponse(lowerQuestion);
    }
    else {
      // إذا لم يتم العثور على كلمات مفتاحية محددة، قدم إجابة عامة
      return `مرحباً! أنا مساعد الكيمياء الحيوية. يمكنني مساعدتك في فهم مفاهيم الكيمياء الحيوية والإجابة على أسئلتك المتعلقة بالبروتينات، الدهون، الكربوهيدرات، الأحماض النووية، الإنزيمات، المسارات الأيضية، وغيرها من المواضيع. كما يمكنني مساعدتك في فهم التجارب المختلفة في المختبر الافتراضي. ما الذي ترغب في معرفته تحديداً؟`;
    }
  }

  // وظيفة للمساعدة في التجارب
  helpWithExperiment(experimentId, query) {
    if (this.experiments[experimentId]) {
      const experiment = this.experiments[experimentId];
      
      // تحويل الاستعلام إلى أحرف صغيرة للمطابقة بشكل أفضل
      const lowerQuery = query.toLowerCase();
      
      // تقديم المساعدة بناءً على نوع الاستعلام
      if (this.containsKeywords(lowerQuery, ["هدف", "أهداف", "غرض", "غاية"])) {
        return `أهداف تجربة "${experiment.title}" هي فهم وتطبيق ${experiment.description}`;
      }
      else if (this.containsKeywords(lowerQuery, ["خطوات", "إجراءات", "طريقة", "كيفية"])) {
        return `للقيام بتجربة "${experiment.title}"، يجب اتباع الخطوات المفصلة في بروتوكول التجربة. يمكنك الاطلاع على الخطوات التفصيلية في صفحة التجربة. بشكل عام، التجربة تتضمن ${experiment.description}`;
      }
      else if (this.containsKeywords(lowerQuery, ["نتائج", "ملاحظات", "استنتاجات"])) {
        return `النتائج المتوقعة من تجربة "${experiment.title}" تعتمد على العينات المستخدمة والظروف التجريبية. بشكل عام، يجب أن تتمكن من ${experiment.description} وتحليل النتائج لاستخلاص استنتاجات علمية.`;
      }
      else if (this.containsKeywords(lowerQuery, ["مشكلة", "خطأ", "صعوبة", "لا يعمل"])) {
        return `إذا كنت تواجه مشكلة في تجربة "${experiment.title}"، تأكد من اتباع الخطوات بالترتيب الصحيح والالتزام بالكميات والظروف المحددة في البروتوكول. تأكد أيضاً من معايرة الأجهزة بشكل صحيح وتحضير المحاليل بدقة. إذا استمرت المشكلة، يمكنك وصف المشكلة بالتفصيل وسأحاول مساعدتك.`;
      }
      else {
        return `مرحباً! أنا هنا للمساعدة في تجربة "${experiment.title}" التي تندرج تحت فئة ${experiment.category}. ${experiment.description} يمكنني مساعدتك في فهم أهداف التجربة، شرح الخطوات، تفسير النتائج، أو حل أي مشكلة تواجهها. ما الذي ترغب في معرفته تحديداً؟`;
      }
    } else {
      return `عذراً، لم أتمكن من العثور على تجربة بالمعرف المحدد. يرجى التحقق من المعرف وإعادة المحاولة.`;
    }
  }

  // وظيفة للتحقق من وجود كلمات مفتاحية في النص
  containsKeywords(text, keywords) {
    return keywords.some(keyword => text.includes(keyword));
  }

  // وظائف لتوليد إجابات متخصصة لكل موضوع
  generateProteinResponse(question) {
    if (this.containsKeywords(question, ["ما هو", "ما هي", "تعريف", "مفهوم"])) {
      return this.knowledgeBase.proteins.definition;
    }
    else if (this.containsKeywords(question, ["بنية", "تركيب", "هيكل"])) {
      return this.knowledgeBase.proteins.structure;
    }
    else if (this.containsKeywords(question, ["وظيفة", "وظائف", "دور", "أدوار"])) {
      return this.knowledgeBase.proteins.functions;
    }
    else if (this.containsKeywords(question, ["مثال", "أمثلة", "نوع", "أنواع"])) {
      return this.knowledgeBa
(Content truncated due to size limit. Use line ranges to read in chunks)